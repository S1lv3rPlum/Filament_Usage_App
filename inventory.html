<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Filament Tracker — Inventory</title>

  <link rel="stylesheet" href="style.css" />
  <meta name="theme-color" content="#007acc" />
</head>

<body>
  <header>
    <h1>Filament Tracker</h1>
  </header>

  <main id="inventory">
    <h2>Spool Inventory</h2>

    <a href="emptyspools.html" class="menu-button">
      Manage Empty Spool Weights
    </a>

    <section id="inventoryListSection" style="margin-top:20px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3>Current Inventory</h3>
        <div style="display: flex; gap: 10px;">
      <button id="toggleLowBtn" onclick="toggleLowSpools()" style="padding: 8px 16px; background: #ffc107; color: #000; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
        Show Only Low Spools
      </button>
        <button id="toggleRetiredBtn" onclick="toggleRetiredSpools()" style="padding: 8px 16px; background: #666; color: white; border: none; border-radius: 6px; cursor: pointer;">
          Show Retired Spools
        </button>
      </div>
      </div>
      <div class="table-wrapper">
        <table id="inventoryTable">
          <thead>
            <tr>
              <th>Brand</th>
              <th>Color</th>
              <th>Material</th>
              <th>Length (m)</th>
              <th>Weight (g)</th>
              <th>Color Details</th>
              <th>Empty Spool</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="retiredSpoolsSection" class="hidden" style="margin-top: 40px;">
      <h3 style="color: #666;">Retired Spools</h3>
      <div class="table-wrapper">
        <table id="retiredSpoolsTable">
          <thead>
            <tr>
              <th>Brand</th>
              <th>Color</th>
              <th>Material</th>
              <th>Weight (g)</th>
              <th>Retired Date</th>
              <th>Reason</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <div style="margin-top:20px;">
      <button onclick="smartBack()">⬅ Back</button>
    </div>
  </main>

  <!-- Retirement Modal -->
  <div id="retirementModal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 400px;">
      <h2>Retire Spool</h2>
      <p id="retireSpoolName" style="font-weight: bold; margin-bottom: 20px;"></p>
      
      <label for="retirementReason">Reason for retiring:</label>
      <select id="retirementReason" style="width: 100%; padding: 10px; margin-bottom: 20px; font-size: 1em; border-radius: 4px; border: 1px solid #ccc;">
        <option value="Empty">Empty - No filament remaining</option>
        <option value="Damaged">Damaged - Filament is tangled or broken</option>
        <option value="Poor Quality">Poor Quality - Print quality issues</option>
        <option value="Other">Other</option>
      </select>

      <div id="otherReasonContainer" class="hidden" style="margin-bottom: 20px;">
        <label for="otherReason">Please specify:</label>
        <input type="text" id="otherReason" placeholder="Enter reason..." style="width: 100%; padding: 10px; margin-top: 5px; font-size: 1em; border-radius: 4px; border: 1px solid #ccc;" />
      </div>

      <div style="display: flex; gap: 10px;">
        <button onclick="confirmRetirement()" style="flex: 1; padding: 12px; background: #ff6b6b; color: white; border: none; border-radius: 6px; font-size: 1em; cursor: pointer;">Retire Spool</button>
        <button onclick="closeRetirementModal()" style="flex: 1; padding: 12px; background: #666; color: white; border: none; border-radius: 6px; font-size: 1em; cursor: pointer;">Cancel</button>
      </div>
    </div>
  </div>

  <footer id="footer">© Data Forge</footer>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <script src="firebase-config.js"></script>
  <script src="inventory.js"></script>
</body>
</html>